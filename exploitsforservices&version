import nmap
import subprocess

# Ask the user for the target IP address
target = input("Enter the target IP address: ")

# Use nmap to scan the target and identify the services and their versions
nm = nmap.PortScanner()
scan_results = nm.scan(target, '1-65535', "-sV", "-sS")
services = scan_results['scan'][target]['tcp']

# Iterate through the list of services and search for available exploits
for port, info in services.items():
    service = info['name']
    version = info['version']
    print(f"Searching for exploits for {service} {version}...")
    
    # Search exploit-db for available exploits
    command = f"searchsploit {service} {version}"
    output = subprocess.run(command, shell=True, capture_output=True)
    if output.returncode == 0:
        # Extract the list of available exploits from the output
        exploit_list = output.stdout.decode().strip().split('\n')
        if exploit_list:
            print(f"Found the following exploits for {service} {version}:")
            for exploit in exploit_list:
                print(f"  - {exploit}")
        else:
            print(f"No exploits found for {service} {version}.")
    else:
        print("Error searching exploit-db.")
